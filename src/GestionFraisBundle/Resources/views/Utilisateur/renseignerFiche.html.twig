{% extends '::base.html.twig' %}

{% block stylesheets %}
    <link href="{{ asset('Css/form.css') }}" rel="stylesheet" xmlns="http://www.w3.org/1999/html">{% endblock %}

{%  block body %}

    <div class="container">
        <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12 " id="contenu">
            <div class="container">
                <div class="row">
                    <div class="col-sm-3 col-xs-6">
                        <p>{{ visiteur.nom }} {{ visiteur.prenom }}</p>
                    </div>
                    <div class="col-sm-3 col-xs-6">
                        <p> Mois : {{ ficheFrais.mois }}</p>
                    </div>

                    <div class="col-sm-6 col-xs-12">
                        <p>Date modification : {{ ficheFrais.dateModif|date("d/m/Y") }}</p>
                    </div>
                </div>


                <div class="row">
                    <div class="col-sm-3 col-xs-12">
                        {% for item in etatFicheFrais %}
                            <p> Etat : {{ item.libelle }}</p>
                        {% endfor %}
                    </div>
                </div>

                <form name="ficheFrais" method="post" action="{{ path('utilisateur_enregistrer', {mois: ficheFrais.mois}) }}" onsubmit="return verifFiche(this)"  onblur="verifChampNumerique(this)">
                    <div class="row" id ="fraisForfait">
                        <h3>Frais Forfait</h3>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th><p>Libelle</p></th>
                                <th><p>Quantité</p></th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for key, item in tabLigneFraisForfait %}
                                <tr>

                                    <td><p>{{ key }}</p></td>
                                    <td>
                                        <input type="number" value="{{ item.quantite }}" name="{{ key }}" min="0" class="form-control " onblur="verifChampNumerique(this)" >
                                    </td>

                                </tr>
                            {% endfor %}

                            </tbody>
                        </table>
                    </div>

                    <div class="bandeau-small"></div>


                    <div class="row" id ="fraisHorsForfait">
                        <h3>Frais Hors Forfait</h3>
                        <div class="bandeau-small"></div>
                        {%  set nbFraisHorsForfait = 0%}

                        {% for key, item in ligneFraisHorsForfait %}
                            {% set nbFraisHorsForfait =  nbFraisHorsForfait + 1  %}
                            <div class="row" id="fraisHorsForfait{{ item.num }}">
                                <table class="table table-bordered" >
                                    <h4>Frais hors forfait n° {{ item.num }}</h4>
                                    <thead>
                                    <tr>
                                        <th><p>Date (jj/mm/aaa)</p></th>
                                        <th><p>Montant</p></th>
                                    </tr>

                                    </thead>
                                    <tbody>
                                        <td>
                                            <input type="date" value="{{ item.date|date('d/m/Y') }}" name ="date[{{ item.num }}]" class="form-control" onblur="verifChampDate(this)">
                                        </td>
                                        <td>
                                            <input type="number" value="{{ item.montant }}" name="montant[{{ item.num }}]" class="form-control" onblur="verifChampNumerique(this)">
                                        </td>

                                        <table class="table table-bordered" id="libelleHF">
                                            <thead>
                                            <tr>
                                                <th><p>Libelle</p></th>
                                            </tr>
                                            </thead>

                                            <tbody>
                                                <tr>

                                                   <td>
                                                        <textarea type="textarea"  name="libelle[{{ item.num }}]" class="form-control" onblur="verifChampText(this)">{{ item.libelleLigneHorsForfait }}</textarea>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </tbody>
                                </table>
                                <buton class="btn btn-default btn-suprimerFraisHF col-xs-3 col-xs-offset-9" id="btn-suprimer{{ item.num }}" onclick="suprimerFrais('{{ item.num }}');">Suprimer</buton>
                            </div>
                            <div class="bandeau-small"></div>
                        {% endfor %}
                    </div>
                    <div class="row">
                     <button type="button" id="btn-ajouter{{ nbFraisHorsForfait }}"  onclick="ajoutFrais({{ nbFraisHorsForfait }});" class="btn btn-default" >Ajouter Frais Hors Forfait</button>
                    </div>
                    <div class="bandeau col-xs-12"></div>

                    <div class="row">
                        <div class="col-xs-2 col-xs-offset-5">
                            <input type="submit" value="Enregistrer" class="btn btn-default "></input>
                        </div>
                    </div>
                    <div class="bandeau-small"></div>
                </form>
            </div>
        </div>
    </div>
    <script language="javascript" src="{{ asset('JavaScript/fraisHF.js') }}"></script>

    <script language="javascript" src="{{ asset('JavaScript/verificationFiche.js') }}"></script>



{% endblock  %}
{% block javascripts %}



{% endblock %}
